-- 테이블 만들기(DDL구문)
DROP TABLE EMP;
CREATE TABLE EMP(
    EMPNO NUMBER(5) PRIMARY KEY,
    ENAME VARCHAR(30) NOT NULL,
    DEPTNO NUMBER(5) NOT NULL,
    MGR VARCHAR2(5),
    JOB VARCHAR2(20) NOT NULL,
    SAL NUMBER(10,0) NOT NULL    
);
-- 아래와 같이 데이터를 입력한다.(11행)
INSERT INTO EMP VALUES(1000, 'TEST1', 20, NULL, 'CLERK', 800);
INSERT INTO EMP VALUES(1001, 'TEST2', 30, '1000', 'SALESMAN', 1000);
INSERT INTO EMP VALUES(1002, 'TEST3', 30, '1000', 'SALESMAN', 2000);
INSERT INTO EMP VALUES(1003, 'TEST4', 20, '1000', 'MANAGER', 2900); 
INSERT INTO EMP VALUES(1004, 'TEST5', 30, '1000', 'SALESMAN', 1000); 
INSERT INTO EMP VALUES(1005, 'TEST6', 30, '1001', 'MANAGER', 2900); 
INSERT INTO EMP VALUES(1006, 'TEST7', 10, NULL, 'MANAGER', 2900); 
INSERT INTO EMP VALUES(1007, 'TEST8', 30, '1002', 'MANAGER', 2200); 
INSERT INTO EMP VALUES(1008, 'TEST9', 10, '1002', 'MANAGER', 2800); 
INSERT INTO EMP VALUES(1009, 'TEST10', 30, '1002', 'SALESMAN', 1500);  
INSERT INTO EMP VALUES(1010, 'TEST11', 20, '1002', 'CLERK', 1100); 

COMMIT;


-- NULL값의 특징 : 모르는 값, 값의 부재, 숫자 혹은 날짜를 더하면 NULL이 된다. 다른 값과 비교할 때 '알수 없음' 반환
-- IS NULL
SELECT * 
 FROM EMP
WHERE MGR IS NULL;

-- IS NOT NULL
SELECT * 
 FROM EMP
WHERE MGR IS NOT NULL;

-- NVL() 함수: MGR NULL일시 0 출력
SELECT NVL(MGR, 0)
 FROM EMP;
 
-- NVL2() 함수 - MGR NULL일시 0, 아닐 시 1 출력
SELECT NVL2(MGR, 1, 0)
 FROM EMP;
 
-- NULLIF() 함수 - 두 수가 같으면 NULL 출력
SELECT NULLIF(10, 10)
 FROM DUAL;

-- COALESCE() 함수 : NULL이 아닌 최초의 인자값 반환
SELECT COALESCE(NULL, NULL, NULL, -100)
 FROM DUAL;
